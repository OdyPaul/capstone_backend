<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Transcript of Records</title>
  <style>
    @page { size: A4; margin: 10mm; }
    html, body { height: 100%; }
    body { margin: 0; font-family: Arial, sans-serif; font-size: 12px; -webkit-print-color-adjust: exact; print-color-adjust: exact; }

    .page {
      position: relative;
      width: 190mm;     /* 210 - 20 */
      height: 277mm;    /* 297 - 20 */
      page-break-after: always;
      box-sizing: border-box;

      background-repeat: no-repeat;
      background-position: 0 0;
      background-size: 190mm 277mm;

      --left: 10mm;
      --right: 10mm;

      --rows-top-first: 92mm;   /* table top on page 1 */
      --rows-top-next:  72mm;   /* table top on p2+ */

      /* absolute fields you can adjust freely */
      --name-x: 35mm;    --name-y: 47mm;
      --admit-x:150mm;   --admit-y: 47mm;

      --addr-x: 35mm;    --addr-y: 54mm;
      --pob-x: 150mm;    --pob-y: 54mm;

      --entr-x: 35mm;    --entr-y: 61mm;
      --dob-x:  150mm;   --dob-y:  61mm;

      --hs-x:   35mm;    --hs-y:   68mm;
      --dgrad-x:150mm;   --dgrad-y:68mm;

      --prog-x: 35mm;    --prog-y: 75mm;
      --major-x:150mm;   --major-y:75mm;

      --grad-x: 150mm;   --grad-y: 82mm;
      --issued-x:35mm;   --issued-y:82mm;
    }

    /* ===== absolute fields (no printed labels) ===== */
    .field { position: absolute; white-space: nowrap; line-height: 1.1; }
    .page.first .name     { left: var(--name-x);   top: var(--name-y); }
    .page.first .admit    { left: var(--admit-x);  top: var(--admit-y); }

    .page.first .address  { left: var(--addr-x);   top: var(--addr-y); max-width: 110mm; overflow: hidden; text-overflow: ellipsis; }
    .page.first .pob      { left: var(--pob-x);    top: var(--pob-y); }

    .page.first .entr     { left: var(--entr-x);   top: var(--entr-y); }
    .page.first .dob      { left: var(--dob-x);    top: var(--dob-y); }

    .page.first .hs       { left: var(--hs-x);     top: var(--hs-y); }
    .page.first .dategrad { left: var(--dgrad-x);  top: var(--dgrad-y); }

    .page.first .program  { left: var(--prog-x);   top: var(--prog-y); }
    .page.first .major    { left: var(--major-x);  top: var(--major-y); }

    .page.first .grad     { left: var(--grad-x);   top: var(--grad-y); }
    .page.first .issued   { left: var(--issued-x); top: var(--issued-y); }

    .page.other .name { left: var(--name-x); top: 47mm; } /* carry name to next pages */

    /* ===== table ===== */
    .grid {
      position: absolute;
      left: var(--left);
      right: var(--right);
      border-collapse: collapse;
      table-layout: fixed;
      font-size: 11px;
    }
    .page.first .grid { top: var(--rows-top-first); }
    .page.other .grid { top: var(--rows-top-next); }

    /* wider TERM column */
    .grid col.col-term   { width: 32mm; }
    .grid col.col-code   { width: 26mm; }
    .grid col.col-subj   { width: auto; }
    .grid col.col-grade  { width: 18mm; }
    .grid col.col-reexam { width: 18mm; }
    .grid col.col-units  { width: 16mm; }

    /* header: top+bottom+left+right borders, centered */
    thead th {
      font-weight: 700;
      text-align: center;
      vertical-align: middle;
      height: 6mm;
      line-height: 6mm;
      padding: 0 2mm;
      border-top: 1px solid #000;
      border-bottom: 1px solid #000;
      border-left: 1px solid #000;
      border-right: 1px solid #000;
      white-space: nowrap;
    }

    /* body cells: only left/right borders (outer edges open) */
    tbody td {
      padding: 0 2mm;
      height: 6mm;
      line-height: 6mm;
      vertical-align: middle;
      overflow: hidden;
      border-top: none;
      border-bottom: none;
      border-left: 1px solid #000;
      border-right: 1px solid #000;
    }
    tbody td:first-child { border-left: none; }
    tbody td:last-child  { border-right: none; }

    .td-code { white-space: nowrap; }
    /* SUBJECTS/DESCRIPTION: allow up to two lines inside the same row */
    .td-subj { white-space: normal; }
    .td-subj .twolines {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 2;     /* clamp to 2 lines */
      overflow: hidden;
      line-height: 3mm;
      height: 6mm;               /* two lines * 3mm */
    }

    .td-grade, .td-reexam, .td-units { text-align: center; }

    /* TERM label: “Sem” with AY on next line */
    .term-wrap { display: inline-block; line-height: 1.0; }
    .term-wrap .ay { font-size: 10px; display: block; margin-top: -1px; }

    tr { page-break-inside: avoid; }
  </style>
</head>
<body>

{{#each pages}}
  <div class="page {{#if @first}}first{{else}}other{{/if}}" style="background-image: url('{{this.bg}}');">

    {{#if @first}}
      <!-- absolute fields (edit positions above) -->
      <div class="field name">{{../fullName}}</div>
      <div class="field admit">{{../dateAdmission}}</div>
      <div class="field address">{{../address}}</div>
      <div class="field pob">{{../placeOfBirth}}</div>
      <div class="field entr">{{../entranceCredentials}}</div>
      <div class="field dob">{{../dateOfBirth}}</div>
      <div class="field hs">{{../highSchool}}</div>
      <div class="field dategrad">{{../dateGraduated}}</div>
      <div class="field program">{{../program}}</div>
      <div class="field major">{{../major}}</div>
      <div class="field grad">{{../dateGraduated}}</div>
      <div class="field issued">{{../dateIssued}}</div>
    {{else}}
      <div class="field name">{{../fullName}}</div>
    {{/if}}

    <table class="grid">
      <colgroup>
        <col class="col-term">
        <col class="col-code">
        <col class="col-subj">
        <col class="col-grade">
        <col class="col-reexam">
        <col class="col-units">
      </colgroup>

      <thead>
        <tr>
          <th>TERM</th>
          <th>COURSE NO.</th>
          <th>SUBJECTS / DESCRIPTION</th>
          <th>FINAL GRADE</th>
          <th>RE-EXAM</th>
          <th>CREDIT</th>
        </tr>
      </thead>

      <tbody>
        {{#each rows}}
          <tr>
            <td class="td-term">
              <span class="term-wrap">{{{this.termHtml}}}</span>
            </td>
            <td class="td-code">{{this.subjectCode}}</td>
            <td class="td-subj"><span class="twolines">{{this.subjectDescription}}</span></td>
            <td class="td-grade">{{this.finalGrade}}</td>
            <td class="td-reexam">{{this.reExam}}</td>
            <td class="td-units">{{this.units}}</td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  </div>
{{/each}}

</body>
</html>
