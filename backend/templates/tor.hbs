<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Transcript of Records</title>
  <style>
    @page { size: A4; margin: 10mm; }
    html, body { height: 100%; }
    body { margin: 0; font-family: Arial, sans-serif; font-size: 12px; -webkit-print-color-adjust: exact; print-color-adjust: exact; }

    .page {
      position: relative;
      width: 190mm;           /* A4 width (210) - left/right margins (10+10) */
      height: 277mm;          /* A4 height (297) - top/bottom margins (10+10) */
      page-break-after: always;
      box-sizing: border-box;

      background-repeat: no-repeat;
      background-position: 0 0;
      background-size: 190mm 277mm;

      --left: 10mm;
      --right: 10mm;

      --rows-top-first: 92mm;
      --rows-top-next: 72mm;

      --name-x: 35mm;    --name-y: 47mm;
      --admit-x: 150mm;  --admit-y: 47mm;

      --addr-x: 35mm;    --addr-y: 54mm;
      --pob-x: 150mm;    --pob-y: 54mm;

      --entrance-x: 35mm; --entrance-y: 61mm;
      --dob-x: 150mm;     --dob-y: 61mm;

      --hs-x: 35mm;       --hs-y: 68mm;
      --dategrad-x: 150mm;--dategrad-y: 68mm;

      --program-x: 35mm;  --program-y: 75mm;
      --major-x: 150mm;   --major-y: 75mm;

      --grad-x: 150mm;    --grad-y: 82mm;
    }

    .field { position: absolute; white-space: nowrap; line-height: 1.1; }

    .page.first .grid { top: var(--rows-top-first); }
    .page.other .grid { top: var(--rows-top-next); }

    .page.first .name     { left: var(--name-x);     top: var(--name-y); }
    .page.first .admit    { left: var(--admit-x);    top: var(--admit-y); }

    .page.first .address  { left: var(--addr-x);     top: var(--addr-y); max-width: 110mm; overflow: hidden; text-overflow: ellipsis; }
    .page.first .pob      { left: var(--pob-x);      top: var(--pob-y); }

    .page.first .entrance { left: var(--entrance-x); top: var(--entrance-y); }
    .page.first .dob      { left: var(--dob-x);      top: var(--dob-y); }

    .page.first .hs       { left: var(--hs-x);       top: var(--hs-y); }
    .page.first .dategrad { left: var(--dategrad-x); top: var(--dategrad-y); }

    .page.first .program  { left: var(--program-x);  top: var(--program-y); }
    .page.first .major    { left: var(--major-x);    top: var(--major-y); }

    .page.first .grad     { left: var(--grad-x);     top: var(--grad-y); }

    .page.other .name { left: var(--name-x); top: 47mm; }

    /* ---- Grid ---- */
    .grid {
      position: absolute;
      left: var(--left);
      right: var(--right);
      border-collapse: collapse;
      table-layout: fixed;
      font-size: 11px;

      /* ðŸ”’ Force content area height per page */
      height: 830px;           /* as requested */
      overflow: hidden;        /* don't spill over */
      display: table;          /* keep table layout behaviors */
    }

    .grid col.col-term   { width: 24mm; }
    .grid col.col-code   { width: 26mm; }
    .grid col.col-subj   { width: auto; }
    .grid col.col-grade  { width: 18mm; }
    .grid col.col-reexam { width: 18mm; }
    .grid col.col-units  { width: 16mm; }

    .grid td {
      border: none;
      padding: 0 3mm 0 2mm;
      height: 6mm;
      line-height: 6mm;
      vertical-align: middle;
      overflow: hidden;
    }

    .td-term { padding-left: 0; }
    .td-code { white-space: nowrap; }
    .td-subj { white-space: nowrap; text-overflow: ellipsis; }
    .td-grade, .td-reexam, .td-units { text-align: center; padding-left: 0; padding-right: 0; }

    /* Two-line term label (semester + AY) shown on EVERY row */
    .term-wrap { display: inline-block; line-height: 1.0; }
    .term-wrap .ay { font-size: 10px; display: block; margin-top: -1px; }
    .term-ay-row td { height: 4mm; line-height: 4mm; }
    .term-ay-row .td-term { padding-left: 0; }
    .term-ay-row .ay { font-size: 10px; }

    tr { page-break-inside: avoid; }
  </style>
</head>
<body>

{{#each pages}}
  <div class="page {{#if @first}}first{{else}}other{{/if}}" style="background-image: url('{{this.bg}}');">
    {{#if @first}}
      <div class="field name">{{../fullName}}</div>
      <div class="field admit">{{../dateAdmission}}</div>

      <div class="field address">{{../address}}</div>
      <div class="field pob">{{../placeOfBirth}}</div>

      <div class="field entrance">{{../entranceCredentials}}</div>
      <div class="field dob">{{../dateOfBirth}}</div>

      <div class="field hs">{{../highSchool}}</div>
      <div class="field dategrad">{{../dateGraduated}}</div>

      <div class="field program">{{../program}}</div>
      <div class="field major">{{../major}}</div>

      <div class="field grad">{{../dateGraduated}}</div>
    {{else}}
      <div class="field name">{{../fullName}}</div>
    {{/if}}

    <table class="grid">
      <colgroup>
        <col class="col-term">
        <col class="col-code">
        <col class="col-subj">
        <col class="col-grade">
        <col class="col-reexam">
        <col class="col-units">
      </colgroup>
     <tbody>
  {{#each rows}}
    {{#if this.isAyRow}}
      <!-- A.Y. row injected right after the first subject of each term -->
      <tr class="term-ay-row">
        <td class="td-term"><span class="ay">{{this.ay}}</span></td>
        <td class="td-code" colspan="5"></td>
      </tr>
    {{else}}
      <!-- Normal subject row -->
      <tr>
        <td class="td-term">
          {{#if this.showSemesterInRow}}
            {{this.semester}}
          {{/if}}
        </td>
        <td class="td-code">{{this.subjectCode}}</td>
        <td class="td-subj">{{this.subjectDescription}}</td>
        <td class="td-grade">{{this.finalGrade}}</td>
        <td class="td-reexam">{{this.reExam}}</td>
        <td class="td-units">{{this.units}}</td>
      </tr>
    {{/if}}
  {{/each}}
</tbody>

    </table>
  </div>
{{/each}}

</body>
</html>
